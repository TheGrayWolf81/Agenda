<html>
  <head>
    <title>Agenda</title>

    <script src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.light_blue-blue.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <style>
      td {
        white-space: normal;
      }
      
      body {
        background-color: #F2F2F2;
      }
      
      table {
        background-color: #FCFCFC;
      }
      
      .mdl-tabs__tab-bar {
        width: 100vw;
        background-color: #bababa;
      }

      .mdl-data-table {
        margin-left: auto;
        margin-right: auto;
        margin-top: 5vh;
        margin-bottom: 5vh;
      }

      .mdl-textfield {
        width: 100%;
      }

      #edit {
        margin: 5vh;
      }
    </style>
  </head>
  <body>
    <main class="mdl-layout__content">
      <div id="main" class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
        <div class="mdl-tabs__tab-bar">
          <a href="#agenda" class="mdl-tabs__tab is-active">Agenda</a>
          <a href="#about" class="mdl-tabs__tab">About</a>
        </div>

        <div class="mdl-tabs__panel is-active" id="agenda">
          <table class="mdl-data-table mdl-js-data-table" style="box-shadow: 10px 10px">
            <thead>
              <tr>
                <th class="mdl-data-table__cell--non-numeric">Class</th>
                <th class="mdl-data-table__cell--non-numeric">Teacher</th>
                <th>Room #</th>
                <th class="mdl-data-table__cell--non-numeric">Homework</th>
              </tr>
            </thead>
            <tbody id="classes"></tbody>
          </table>
        </div>

        <div class="mdl-tabs__panel" id="about">
          <span class="mdl-layout-title">Agenda</span>
          <br>
          Created by <a href="https://www.youtube.com/channel/UCWa--6L7aAcTJInaX9hh4xg">Richard Yanchev</a> and <a href="https://theandroidmaster.github.io/">James Fenn</a>.
          <br>
          <br>
          For any questions or suggestions, please email <a href="mailto:19riyanchev40@northallegheny.org">19riyanchev40@northallegheny.org</a>.
        </div>
      </div>

      <div id="edit" style="display: none;">
        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="name">
          <label class="mdl-textfield__label" for="name">Class Name</label>
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="teacher">
          <label class="mdl-textfield__label" for="teacher">Teacher</label>
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" pattern="-?[0-9]*(\.[0-9]+)?" id="room">
          <label class="mdl-textfield__label" for="room">Room Number</label>
          <span class="mdl-textfield__error">Input is not a number!</span>
        </div>

        <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
          <input class="mdl-textfield__input" type="text" id="homework">
          <label class="mdl-textfield__label" for="homework">Homework</label>
        </div>

        <button type="button" class="mdl-button" onclick="cancelEdit();">Cancel</button>
        <button id="save" type="button" class="mdl-button">Save</button>
      </div>
    </main>
  </body>
  <script>
  var classes = [
    {
      index: 0,
      name: "Period 1",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 1,
      name: "Period 2",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 2,
      name: "Period 3",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 3,
      name: "Period 4",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 4,
      name: "Period 5",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 5,
      name: "Period 6",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 6,
      name: "Period 7",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 7,
      name: "Period 8",
      teacher: "",
      room: 0,
      homework: ""
    },
    {
      index: 8,
      name: "Period 9",
      teacher: "",
      room: 0,
      homework: ""
    }
  ];

  function loadClasses() {
    if (typeof(Storage) !== "undefined") {
      var stored = localStorage.getItem("classes");
      if (stored != null) classes = JSON.parse(stored);
    }

    var HTML = "";
    classes.forEach(function(item, index, array) {
      HTML += getTableItem(item);
    });
    document.getElementById("classes").innerHTML = HTML;
  }

  function getTableItem(item) {
    return "<tr onclick=\"edit(classes[" + classes.indexOf(item) + "]);\"><td class=\"mdl-data-table__cell--non-numeric\">" + item.name + "</td><td class=\"mdl-data-table__cell--non-numeric\">" + item.teacher + "</td><td>" + item.room + "</td><td class=\"mdl-data-table__cell--non-numeric\">" + item.homework + "</td></tr>";
  }

  function edit(item) {
    document.getElementById("edit").style.display = null;
    document.getElementById("main").style.display = "none";

    document.getElementById("name").parentElement.MaterialTextfield.change(item.name);
    document.getElementById("teacher").parentElement.MaterialTextfield.change(item.teacher);
    document.getElementById("room").parentElement.MaterialTextfield.change(item.room);
    document.getElementById("homework").parentElement.MaterialTextfield.change(item.homework);

    document.getElementById("save").onclick = function() {
      saveEdit(item);
    }
  }

  function saveEdit(item) {
    document.getElementById("edit").style.display = "none";
    document.getElementById("main").style.display = null;

    item.name = document.getElementById("name").value;
    item.teacher = document.getElementById("teacher").value;
    item.room = document.getElementById("room").value;
    item.homework = document.getElementById("homework").value;

    saveClasses();
  }

  function cancelEdit() {
    document.getElementById("edit").style.display = "none";
    document.getElementById("main").style.display = null;
  }

  function saveClasses() {
    if (typeof(Storage) !== "undefined") {
      localStorage.setItem("classes", JSON.stringify(classes));
    } else {
      alert("You are not currently using a supported browser. Please update your browser or switch to a less outdated piece of trash.");
    }

    loadClasses();
  }

  loadClasses();
  </script>
</html>
